const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ProductDetails-CXAsq6YQ.js","assets/utils-DZkesnri.js","assets/utils-BfsFj6PV.css"])))=>i.map(i=>d[i]);
import{P as L}from"./ProductList-BzdPahzd.js";import{c as b,g as m,d as f,r as p,s as y,l as C}from"./utils-DZkesnri.js";const P="modulepreload",I=function(o){return"/trueCommerce/"+o},g={},w=function(t,e,r){let n=Promise.resolve();if(e&&e.length>0){let c=function(i){return Promise.all(i.map(d=>Promise.resolve(d).then(u=>({status:"fulfilled",value:u}),u=>({status:"rejected",reason:u}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),h=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));n=c(e.map(i=>{if(i=I(i),i in g)return;g[i]=!0;const d=i.endsWith(".css"),u=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${i}"]${u}`))return;const l=document.createElement("link");if(l.rel=d?"stylesheet":P,d||(l.as="script"),l.crossOrigin="",l.href=i,h&&l.setAttribute("nonce",h),document.head.appendChild(l),d)return new Promise((v,_)=>{l.addEventListener("load",v),l.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${i}`)))})}))}function s(c){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=c,window.dispatchEvent(a),!a.defaultPrevented)throw c}return n.then(c=>{for(const a of c||[])a.status==="rejected"&&s(a.reason);return t().catch(s)})};class S{constructor(t="/json/alerts.json"){this.alertUrl=t}async init(){try{const t=await fetch(this.alertUrl);if(!t.ok)throw new Error("Failed to fetch alerts");const e=await t.json();e.length>0&&this.renderAlerts(e)}catch(t){console.error("Alert error:",t)}}renderAlerts(t){const e=document.createElement("section");e.classList.add("alert-list"),t.forEach(n=>{const s=document.createElement("p");s.textContent=n.message,s.style.backgroundColor=n.background||"black",s.style.color=n.color||"white",s.style.padding="1rem",s.style.margin="0",e.appendChild(s)});const r=document.querySelector("main");r&&r.prepend(e)}}function k(o){if(o.ok)return o.json();throw new Error(`Bad response: ${o.status} ${o.statusText}`)}class E{constructor(t){this.category=t,this.path=`/json/${this.category}.json`}async getData(){try{return await fetch(this.path).then(k)}catch(t){return console.error("Error loading data:",t),[]}}async findProductById(t){return(await this.getData()).find(r=>r.Id===t)}}const $=Object.freeze(Object.defineProperty({__proto__:null,default:E},Symbol.toStringTag,{value:"Module"}));class T{constructor(t,e){this.key=t,this.listElement=e}init(){this.renderCartContents(),this.addEventListeners()}cartItemTemplate(t){return`
      <li class="cart-card divider">
        <a href="#" class="cart-card__image">
          <img src="${b(t)}" alt="${t.Name}" />
        </a>
        <a href="#">
          <h2 class="card__name">${t.Name}</h2>
        </a>
        <p class="cart-card__color">${t.Colors[0].ColorName}</p>

        <div class="cart-actions">
          <div class="quantity-control">
            <button class="qty-btn add" data-id="${t.Id}">+</button>
            <span class="qty-text">${t.Quantity}</span>
            <button class="qty-btn subtract" data-id="${t.Id}">-</button>
            <button class="qty-btn remove" data-id="${t.Id}">X</button>
          </div>
          <p class="cart-card__price">$${(t.FinalPrice*t.Quantity).toFixed(2)}</p>
        </div>
      </li>
    `}renderCartContents(){if(!this.listElement)return;const t=m(this.key)||[];this.listElement.innerHTML="",t.length>0?(this.listElement.innerHTML=t.map(e=>this.cartItemTemplate(e)).join(""),this.calculateCartTotal(t)):(this.listElement.innerHTML="<p>Your cart is empty.</p>",this.calculateCartTotal(null))}calculateCartTotal(t){const e=document.querySelector(".cart-footer");if(!e)return;if(!t||t.length===0){e.classList.add("hide");return}let r=0;t.forEach(s=>{const c=parseFloat(s.FinalPrice||s.price||0),a=s.Quantity||1;r+=c*a});const n=document.querySelector(".cart-total");n&&(n.textContent=`Total: $${r.toFixed(2)}`,e.classList.remove("hide"))}changeQuantity(t,e){let r=m(this.key)||[],n=f(r,"Id",e);if(!(n<0)){switch(t){case"add":r[n].Quantity+=1;break;case"subtract":r[n].Quantity===1?r.splice(n,1):r[n].Quantity-=1;break}r.length===0?p(this.key):y(this.key,r),this.renderCartContents()}}removeItem(t){let e=m(this.key)||[],r=f(e,"Id",t);r>-1&&(e.splice(r,1),e.length===0?p(this.key):y(this.key,e)),this.renderCartContents()}addEventListeners(){this.listElement&&this.listElement.addEventListener("click",t=>{t.target.classList.contains("add")&&this.changeQuantity("add",t.target.dataset.id),t.target.classList.contains("subtract")&&this.changeQuantity("subtract",t.target.dataset.id),t.target.classList.contains("remove")&&this.removeItem(t.target.dataset.id)})}}document.addEventListener("DOMContentLoaded",async()=>{await C(),new S().init();const t=window.location.pathname;if(t.includes("cart")){const e=document.querySelector(".product-list");e&&new T("so-cart",e).init()}if(t.includes("product_listing")){const r=new URLSearchParams(window.location.search).get("category")||"tents",n=new E(r),s=document.querySelector(".product-list");s&&new L(r,n,s).init()}if(t.includes("product_pages")){const{default:e}=await w(async()=>{const{default:a}=await import("./ProductDetails-CXAsq6YQ.js");return{default:a}},__vite__mapDeps([0,1,2])),r=(await w(async()=>{const{default:a}=await Promise.resolve().then(()=>$);return{default:a}},void 0)).default,n=new URLSearchParams(window.location.search),s=n.get("product"),c=n.get("category")||"tents";if(s){const a=new r(c);new e(s,a).init()}}});
